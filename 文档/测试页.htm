<html>
	<head>
		<TITLE> ocx test </TITLE>
		<script>
			
			
			function doReadOper()
			{
				//alert("进入测试程序:");
				var i;
				var ErrorInfo;
				i = SX_CARDOCX1.ReadOperCardNo();
				if (i != 0) 
				{alert("获取卡片信息失败:"+SX_CARDOCX1.ErrInfo+"返回值："+i);
				 return -1;
				} 
				var mycardno;
				
				mycardno=SX_CARDOCX1.OperCardNo;
				
				alert("操作员卡号:"+mycardno);
			
				
			}
			
			function doRead()
			{
				//alert("进入测试程序:");
				var i;
				var ErrorInfo;
				i = SX_CARDOCX1.ReadCardNo();
				if (i != 0) 
				{alert("获取卡片信息失败:"+SX_CARDOCX1.ErrInfo+"返回值："+i);
				 return -1;
				} 
				var mycardno;
				
				mycardno=SX_CARDOCX1.CardNo;
				//SX_CARDOCX1.CardNo = "12341234";
				
				alert("用户卡号:"+mycardno);
			}

			function doRead2()
			{
				//alert("进入测试程序:");
				var i;
				var ErrorInfo;
				i = SX_CARDOCX1.ReadInfo(SX_CARDOCX1.OperCardNo);
				if (i != 0) 
				{alert("获取卡片信息失败:"+SX_CARDOCX1.ErrInfo+"返回值："+i);
				 return -1;
				} 
				var mycardno2,myapptype,myappversion,mysn,mystartdate,myenddate,myfci,mycardtype,mytradeno,mybalance;
				mycardno2 = SX_CARDOCX1.CARDNO;
				myapptype = SX_CARDOCX1.AppType;
				myappversion = SX_CARDOCX1.AppVersion;
				mysn = SX_CARDOCX1.AppSn;
				mystartdate = SX_CARDOCX1.AppStartDate;
				myenddate = SX_CARDOCX1.AppEndDate;
				myfci = SX_CARDOCX1.FCI;
				mycardtype = SX_CARDOCX1.CardType;
				mytradeno = SX_CARDOCX1.Tradeno;
				mybalance = SX_CARDOCX1.Balance;
				
				alert("卡号:"+mycardno2+" 应用类型:"+myapptype+" 应用版本:"+myappversion+" 卡序列号:"+mysn+
				      " 启用日期:"+mystartdate+" 有效期:"+myenddate+" 卡类型:"+mycardtype+" 卡序列号:"+mytradeno+
				      " 卡内余额:"+mybalance+" 内部员工标识:"+SX_CARDOCX1.StaffTag);
	
			}
			
			function doReadYP()
			{
				//alert("进入测试程序:");
				var i;
				var ErrorInfo;
				i = SX_CARDOCX1.GetYuepiaoIndex(SX_CARDOCX1.OperCardNo);
				if (i != 0) 
				{alert("获取卡片信息失败:"+SX_CARDOCX1.ErrInfo+"返回值："+i);
				 return -1;
				} 
				var YPFlag,Privilege,AppRange,YearInfo,PriIndex1,PriIndex2,PriIndex3,PriIndex4,PriIndex5,PriIndex6,CRCCheck;
				YPFlag = SX_CARDOCX1.YPFlag;
				Privilege = SX_CARDOCX1.Privilege;
				AppRange = SX_CARDOCX1.AppRange;
				YearInfo = SX_CARDOCX1.YearInfo;
				PriIndex1 = SX_CARDOCX1.PriIndex1;
				PriIndex2 = SX_CARDOCX1.PriIndex2;
				PriIndex3 = SX_CARDOCX1.PriIndex3;
				PriIndex4 = SX_CARDOCX1.PriIndex4;
				PriIndex5 = SX_CARDOCX1.PriIndex5;
				PriIndex6 = SX_CARDOCX1.PriIndex6;
				CRCCheck = SX_CARDOCX1.CRCCheck;
				
				alert("月票类型:"+YPFlag+" 优惠类型:"+Privilege+" 应用标志范围:"+AppRange+" 年审信息:"+YearInfo+
				      " 优惠索引1:"+PriIndex1+" 优惠索引2:"+PriIndex2+" 优惠索引3:"+PriIndex3+" 优惠索引4:"+PriIndex4+
				      " 优惠索引5:"+PriIndex5+" 优惠索引6:"+SX_CARDOCX1.PriIndex6+" CRC校验:"+SX_CARDOCX1.CRCCheck);
	
			}

		</script>
	</head>
	<body>                            
		<object id="SX_CARDOCX1" classid="clsid:0362744E-0794-4020-B5B0-355ED58A736D"  width="0" height="0" >
		</object>
		<input type="button" value="读取操作员卡号" onclick="javascript:doReadOper()">
		<input type="button" value="读取用户卡号" onclick="javascript:doRead()">
		<input type="button" value="读取用户卡信息" onclick="javascript:doRead2()">
		<input type="button" value="读取月票信息" onclick="javascript:doReadYP()">	
		
	</body>
</html>