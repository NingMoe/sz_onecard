function ctTreeInfo(A,B,C,D){this.nodeProperties=A;this.currentItem=null;this.prefix=B;this.hideType=C;this.expandLevel=D;this.beginIndex=0;this.endIndex=0}function ctMenuInfo(B,A){this.id=B;this.idSub=A}var _ctIDSubMenuCount=0;var _ctIDSubMenu="ctSubTreeID";var _ctCurrentItem=null;var _ctNoAction=new Object();var _ctItemList=new Array();var _ctTreeList=new Array();var _ctMenuList=new Array();var _ctMenuInitStr="";var _ctNodeProperties={folderLeft:[["",""]],folderRight:[["",""]],itemLeft:[""],itemRight:[""],folderConnect:[[["",""],["",""]]],itemConnect:[["",""],["",""]],spacer:[["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"]],themeLevel:1};function ctNewSubMenuID(){return _ctIDSubMenu+(++_ctIDSubMenuCount)}function ctActionItem(){return' onmouseover="ctItemMouseOver (this.parentNode)" onmouseout="ctItemMouseOut (this.parentNode)" onmousedown="ctItemMouseDown (this.parentNode)" onmouseup="ctItemMouseUp (this.parentNode)"'}function ctNoActionItem(A){return A[1]}function ctGetPropertyLevel(B,A){return(B>=A.length)?(A.length-1):B}function ctCollapseTree(C){var B=ctGetObject(C).firstChild;var A;for(A=0;A<B.ctItems.length;++A){ctCloseFolder(B.ctItems[A])}}function ctExpandTree(D,C){if(C<=0){return }var B=ctGetObject(D);if(!B){return }var A=B.firstChild;if(!A){return }ctExpandTreeSub(A,C)}function ctExpandTreeSub(A,D){if(A.ctLevel>=D){return }var B;var C;for(B=0;B<A.ctItems.length;++B){C=A.ctItems[B];if(C.ctIdSub){ctOpenFolder(C);ctExpandTreeSub(ctGetObject(C.ctIdSub),D)}}}function ctExposeItem(E,C){if(E<0||E>=_ctTreeList.length){return }var A=_ctTreeList[E];var D=A.endIndex;var B;for(B=A.beginIndex;B<D;++B){if(_ctItemList[B].length>2&&_ctItemList[B][2]==C){return ctExposeTreeIndex(E,B)}}}function ctExposeTreeIndex(D,B){var C=ctGetObject("ctItemID"+(_ctTreeList[D].beginIndex+B)).parentNode;if(!C){return null}var A=ctGetThisMenu(C).ctParent;if(A){ctExposeTreeIndexSub(A)}ctSetSelectedItem(C);return C}function ctExposeTreeIndexSub(B){var A=ctGetThisMenu(B).ctParent;if(A){ctExposeTreeIndexSub(A)}ctOpenFolder(B)}function ctMarkItem(F,D){if(F<0||F>=_ctTreeList.length){return }var A=_ctTreeList[F];var E=A.endIndex;var B;for(B=A.beginIndex;B<E;++B){if(_ctItemList[B].length>2&&_ctItemList[B][2]==D){var C=ctGetObject("ctItemID"+(_ctTreeList[F].beginIndex+B)).parentNode;if(!C){return null}if(C.id=="JSCookTreeItem"){C.id="JSCookTreeMarked"}return C}}}function ctMarkTreeIndex(C,A){var B=ctGetObject("ctItemID"+(_ctTreeList[C].beginIndex+A)).parentNode;if(!B){return null}if(B.id=="JSCookTreeItem"){B.id="JSCookTreeMarked"}return B}function ctGetSelectedItem(A){if(_ctTreeList[A].hideType<=1){return _ctTreeList[A].currentItem}else{return _ctCurrentItem}}function ctDraw(id,tree,nodeProperties,prefix,hideType,expandLevel){var obj=ctGetObject(id);if(!nodeProperties){nodeProperties=_ctNodeProperties}if(!prefix){prefix=""}if(!hideType){hideType=0}if(!expandLevel){expandLevel=0}_ctTreeList[_ctTreeList.length]=new ctTreeInfo(nodeProperties,prefix,hideType,expandLevel);var treeIndex=_ctTreeList.length-1;var beginIndex=_ctItemList.length;_ctMenuInitStr="";var str=ctDrawSub(tree,true,null,treeIndex,0,nodeProperties,prefix,"");obj.innerHTML=str;eval(_ctMenuInitStr);_ctMenuInitStr="";var endIndex=_ctItemList.length;_ctTreeList[treeIndex].beginIndex=beginIndex;_ctTreeList[treeIndex].endIndex=endIndex;if(expandLevel){ctExpandTree(id,expandLevel)}return treeIndex}function ctDrawSub(R,H,P,N,B,G,S,L){var O=B;if(O>G.themeLevel){O=G.themeLevel}var Q='<div class="'+S+"TreeLevel"+O+'"';if(!H){Q+=' id="'+P+'"'}Q+=">";var J="";var W;var I;var V;var K;var F;var A;var E;var U;var D;var X;var M=G.themeLevel;var T;if(H){T=0}else{T=5}var C=' class="'+S+'Row"';for(;T<R.length;++T){W=R[T];if(!W){continue}_ctItemList[_ctItemList.length]=W;E=_ctItemList.length-1;V=(W.length>6);I=V?ctNewSubMenuID():null;Q+='<table cellspacing="0" class="'+S+'Table">';Q+="<tr"+C;if(V){Q+=' id="JSCookTreeFolderClosed">'}else{Q+=' id="JSCookTreeItem">'}K=S+(V?"Folder":"Item");D="ctItemID"+E;X=' id="'+D+'"';_ctMenuInitStr+='ctSetupItem (ctGetObject ("'+D+'").parentNode,'+E+","+N+","+B+","+(I?('"'+I+'"'):"null")+");";Q+='<td class="'+K+'Spacer"'+X+">"+L;Q+="</td>";if(W[0]==_ctNoAction){Q+=ctNoActionItem(W,S);Q+="</tr></table>";continue}U=ctActionItem();Q+='<td class="'+K+'Left"'+U+">";if(V){F=ctHasNextItem(T,R)?0:1;O=ctGetPropertyLevel(B,G.folderConnect);Q+='<span class="JSCookTreeFolderClosed">'+G.folderConnect[O][F][0]+'</span><span class="JSCookTreeFolderOpen">'+G.folderConnect[O][F][1]+"</span>"}else{F=ctHasNextItem(T,R)?0:1;O=ctGetPropertyLevel(B,G.itemConnect);Q+=G.itemConnect[O][F]}if(W[0]!=null&&W[0]!=_ctNoAction){Q+=W[0]}else{if(V){O=ctGetPropertyLevel(B,G.folderLeft);Q+='<span class="JSCookTreeFolderClosed">'+G.folderLeft[O][0]+'</span><span class="JSCookTreeFolderOpen">'+G.folderLeft[O][1]+"</span>"}else{O=ctGetPropertyLevel(B,G.itemLeft);Q+=G.itemLeft[O]}}Q+="</td>";Q+='<td class="'+K+'Text"'+U+">";Q+="<a";if(W[2]!=null){Q+=' href="'+W[2]+'"';if(W[3]){Q+=' target="'+W[3]+'"'}}if(W[4]!=null){Q+=' title="'+W[4]+'"'}else{Q+=' title="'+W[1]+'"'}if(W[5]!=null){Q+=' onclick="return '+W[5]+'();"'}Q+=">"+W[1]+"</a></td>";Q+='<td class="'+K+'Right"'+U+">";if(V){O=ctGetPropertyLevel(B,G.folderRight);Q+='<span class="JSCookTreeFolderClosed">'+G.folderRight[O][0]+'</span><span class="JSCookTreeFolderOpen">'+G.folderRight[O][1]+"</span>"}else{O=ctGetPropertyLevel(B,G.itemRight);Q+=G.itemRight[O]}Q+="</td>";Q+="</tr></table>";if(V){A=L;O=ctGetPropertyLevel(B,G.spacer);A+=G.spacer[O][F];Q+=ctDrawSub(W,false,I,N,B+1,G,S,A)}}Q+="</div>";return Q}function ctItemMouseOver(B){var C=_ctItemList[B.ctIndex];var D=ctIsDefaultItem(C);if(D){var A=ctGetDefaultClassName(B);if(B.className==A){B.className=A+"Hover"}}}function ctItemMouseOut(D){if(ctIsDefaultItem(_ctItemList[D.ctIndex])){var C=ctGetDefaultClassName(D);if(D.className==(C+"Hover")||D.className==(C+"Active")){var A=_ctTreeList[D.ctTreeIndex];var B=(A.hideType<=1)?A.currentItem:_ctCurrentItem;if(D==B){D.className=C+"Selected"}else{D.className=C}}}}function ctItemMouseDown(B){if(ctIsDefaultItem(_ctItemList[B.ctIndex])){var A=ctGetDefaultClassName(B);if(B.className==(A+"Hover")){B.className=A+"Active"}}}function ctItemMouseUp(B){if(B.ctIdSub){var A=ctGetObject(B.ctIdSub);if(A.style.display=="block"){ctCloseFolder(B)}else{ctOpenFolder(B)}}ctSetSelectedItem(B)}function ctSetSelectedItem(D){var A=_ctTreeList[D.ctTreeIndex];var E=A.hideType;var B;if(E<=1){B=A.currentItem}else{B=_ctCurrentItem}if(B!=D){ctLabelMenu(D);if(B){if(ctIsDefaultItem(_ctItemList[B.ctIndex])){var C=ctGetDefaultClassName(B);if(B.className==(C+"Selected")){B.className=C}}if(E>0&&B){ctHideMenu(B,D)}}if(E<=1){A.currentItem=D}else{_ctCurrentItem=D}if(ctIsDefaultItem(_ctItemList[D.ctIndex])){var C=ctGetDefaultClassName(D);D.className=C+"Selected"}}}function ctIsFolderOpen(A){if(A.id=="JSCookTreeFolderOpen"){return true}return false}function ctOpenFolder(B){if(ctIsFolderOpen(B)){return }if(B.ctIdSub){var A=ctGetObject(B.ctIdSub);A.style.display="block";B.id="JSCookTreeFolderOpen"}}function ctCloseFolder(C){if(!ctIsFolderOpen(C)){return }if(C.ctIdSub){var A=ctGetObject(C.ctIdSub);var B;for(B=0;B<A.ctSubMenu.length;++B){ctCloseFolder(A.ctSubMenu[B].ctParent)}var D=_ctTreeList[C.ctTreeIndex].expandLevel;if(C.ctLevel<D){return }A.style.display="none";C.id="JSCookTreeFolderClosed"}}function ctSetupItem(D,C,F,G,A){if(!D.ctIndex){D.ctIndex=C;D.ctTreeIndex=F;D.ctLevel=G;D.ctIdSub=A}var E=ctGetThisMenu(D);ctSetupMenu(E,D,null,null);if(A){var B=ctGetObject(A);ctSetupMenu(B,null,E,D)}}function ctSetupMenu(D,C,B,A){if(!D.ctSubMenu){D.ctSubMenu=new Array()}if(A){if(!D.ctParent){D.ctParent=A;D.ctLevel=A.ctLevel+1;B.ctSubMenu[B.ctSubMenu.length]=D}}if(C){if(!C.ctMenu){C.ctMenu=D;D.ctLevel=C.ctLevel;if(!D.ctItems){D.ctItems=new Array()}D.ctItems[D.ctItems.length]=C}}}function ctLabelMenu(A){var B=ctGetThisMenu(A);while(B&&B.ctLevel!=0){B.ctCurrentItem=A;B=ctGetThisMenu(B.ctParent)}}function ctHideMenu(B,C){var A;while(B){if(B.ctIdSub&&(A=ctGetObject(B.ctIdSub)).ctLevel&&(A.ctCurrentItem!=C)){ctCloseFolder(B)}B=ctGetThisMenu(B).ctParent}}function ctGetThisMenu(C){var D=_ctTreeList[C.ctTreeIndex].prefix;if(C.ctLevel==0){D+="TreeLevel0"}else{var A=_ctTreeList[C.ctTreeIndex].nodeProperties.themeLevel;var B=(C.ctLevel<A)?C.ctLevel:A;D+="TreeLevel"+B}while(C){if(C.className==D){return C}C=C.parentNode}return null}function ctHasNextItem(B,A){if(B<(A.length-2)||(B==(A.length-2)&&A[B+1])){return true}else{return false}}function ctGetDefaultClassName(B){var A=_ctTreeList[B.ctTreeIndex];return A.prefix+"Row"}function ctIsDefaultItem(A){if(A[0]==_ctNoAction){return false}return true}function ctGetObject(A){if(document.all){return document.all[A]}return document.getElementById(A)}function ctGetProperties(B){var C=B+":\n";var A;for(A in B){C+=A+" = "+B[A]+"; "}return C};